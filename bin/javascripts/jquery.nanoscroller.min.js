(function(d,h,j){var l,i,k,m,n,o;n={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null};l="Microsoft Internet Explorer"===h.navigator.appName&&/msie 7./i.test(h.navigator.appVersion)&&h.ActiveXObject;i=null;k={};o=function(){var b,a;b=j.createElement("div");a=b.style;a.position="absolute";a.width="100px";a.height="100px";a.overflow="scroll";a.top="-9999px";
j.body.appendChild(b);a=b.offsetWidth-b.clientWidth;j.body.removeChild(b);return a};m=function(){function b(a,c){this.el=a;this.options=c;i||(i=o());this.$el=d(this.el);this.doc=d(j);this.win=d(h);this.generate();this.createEvents();this.addEvents();this.reset()}b.prototype.preventScrolling=function(a,c){this.isActive&&("DOMMouseScroll"===a.type?("down"===c&&0<a.originalEvent.detail||"up"===c&&0>a.originalEvent.detail)&&a.preventDefault():"mousewheel"===a.type&&a.originalEvent&&a.originalEvent.wheelDelta&&
("down"===c&&0>a.originalEvent.wheelDelta||"up"===c&&0<a.originalEvent.wheelDelta)&&a.preventDefault())};b.prototype.updateScrollValues=function(){var a;a=this.content[0];this.maxScrollTop=a.scrollHeight-a.clientHeight;this.contentScrollTop=a.scrollTop;this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop};b.prototype.handleKeyPress=function(a){var c;if(38===a||33===a||40===a||34===a)c=38===a||40===a?40:0.9*this.paneHeight,c=100*
(c/(this.contentHeight-this.paneHeight)),c=c*this.maxSliderTop/100,this.sliderY=38===a||33===a?this.sliderY-c:this.sliderY+c,this.scroll();else if(36===a||35===a)this.sliderY=36===a?0:this.maxSliderTop,this.scroll()};b.prototype.createEvents=function(){var a=this;this.events={down:function(c){a.isBeingDragged=!0;a.offsetY=c.pageY-a.slider.offset().top;a.pane.addClass("active");a.doc.bind("mousemove",a.events.drag).bind("mouseup",a.events.up);return!1},drag:function(c){a.sliderY=c.pageY-a.$el.offset().top-
a.offsetY;a.scroll();a.updateScrollValues();a.contentScrollTop>=a.maxScrollTop?a.$el.trigger("scrollend"):0===a.contentScrollTop&&a.$el.trigger("scrolltop");return!1},up:function(){a.isBeingDragged=!1;a.pane.removeClass("active");a.doc.unbind("mousemove",a.events.drag).unbind("mouseup",a.events.up);return!1},resize:function(){a.reset()},panedown:function(c){a.sliderY=(c.offsetY||c.originalEvent.layerY)-0.5*a.sliderHeight;a.scroll();a.events.down(c);return!1},scroll:function(c){a.isBeingDragged||(a.updateScrollValues(),
a.sliderY=a.sliderTop,a.slider.css({top:a.sliderTop}),null!=c&&(a.contentScrollTop>=a.maxScrollTop?(a.options.preventPageScrolling&&a.preventScrolling(c,"down"),a.$el.trigger("scrollend")):0===a.contentScrollTop&&(a.options.preventPageScrolling&&a.preventScrolling(c,"up"),a.$el.trigger("scrolltop"))))},wheel:function(c){if(null!=c)return a.sliderY+=-c.wheelDeltaY||-c.delta,a.scroll(),!1},keydown:function(c){var b;if(null!=c&&(b=c.which,38===b||33===b||40===b||34===b||36===b||35===b))a.sliderY=isNaN(a.sliderY)?
0:a.sliderY,k[b]=setTimeout(function(){a.handleKeyPress(b)},100),c.preventDefault()},keyup:function(c){null!=c&&(c=c.which,a.handleKeyPress(c),null!=k[c]&&clearTimeout(k[c]))}}};b.prototype.addEvents=function(){var a;this.removeEvents();a=this.events;this.options.disableResize||this.win.bind("resize",a.resize);this.slider.bind("mousedown",a.down);this.pane.bind("mousedown",a.panedown).bind("mousewheel DOMMouseScroll",a.wheel);this.content.bind("scroll mousewheel DOMMouseScroll touchmove",a.scroll);
this.options.keyboardSupport&&this.addKeyboardEvents()};b.prototype.addKeyboardEvents=function(){this.content.bind("keydown",events.keydown).bind("keyup",events.keyup)};b.prototype.removeEvents=function(){var a;a=this.events;this.win.unbind("resize",a.resize);this.slider.unbind();this.pane.unbind();this.content.unbind("scroll mousewheel DOMMouseScroll touchmove",a.scroll).unbind("keydown",a.keydown).unbind("keyup",a.keyup)};b.prototype.generate=function(){var a,c,b,g,e;b=this.options;g=b.paneClass;
e=b.sliderClass;a=b.contentClass;0===this.$el.find(""+g).length&&0===this.$el.find(""+e).length&&this.$el.append('<div class="'+g+'"><div class="'+e+'" /></div>');this.content=this.$el.children("."+a);this.content.attr("tabindex",0);this.slider=this.$el.find("."+e);this.pane=this.$el.find("."+g);i&&(c={right:-i},this.$el.addClass("has-scrollbar"));b.iOSNativeScrolling&&(null==c&&(c={}),c.WebkitOverflowScrolling="touch");null!=c&&this.content.css(c);b.alwaysVisible&&this.pane.css({opacity:1,visibility:"visible"});
return this};b.prototype.restore=function(){this.stopped=!1;this.pane.show();return this.addEvents()};b.prototype.reset=function(){var a,b,d,g,e,h,f;this.$el.find("."+this.options.paneClass).length||this.generate().stop();this.stopped&&this.restore();a=this.content[0];d=a.style;g=d.overflowY;l&&this.content.css({height:this.content.height()});b=a.scrollHeight+i;h=this.pane.outerHeight();f=parseInt(this.pane.css("top"),10);e=parseInt(this.pane.css("bottom"),10);e=h+f+e;f=Math.round(e/b*e);f<this.options.sliderMinHeight?
f=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&f>this.options.sliderMaxHeight&&(f=this.options.sliderMaxHeight);"scroll"===g&&"scroll"!==d.overflowX&&(f+=i);this.maxSliderTop=e-f;this.contentHeight=b;this.paneHeight=h;this.paneOuterHeight=e;this.sliderHeight=f;this.slider.height(f);this.events.scroll();this.pane.show();this.isActive=!0;this.pane.outerHeight(!0)>=a.scrollHeight&&"scroll"!==g?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===a.scrollHeight&&"scroll"===g?
this.slider.hide():this.slider.show();return this};b.prototype.scroll=function(){this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.content.scrollTop(-1*((this.paneHeight-this.contentHeight+i)*this.sliderY/this.maxSliderTop));this.slider.css({top:this.sliderY});return this};b.prototype.scrollBottom=function(a){this.reset();this.content.scrollTop(this.contentHeight-this.content.height()-a).trigger("mousewheel");return this};b.prototype.scrollTop=function(a){this.reset();
this.content.scrollTop(+a).trigger("mousewheel");return this};b.prototype.scrollTo=function(a){this.reset();a=d(a).offset().top;a>this.maxSliderTop&&(a/=this.contentHeight,this.sliderY=a*=this.maxSliderTop,this.scroll());return this};b.prototype.stop=function(){this.stopped=!0;this.removeEvents();this.pane.hide();return this};b.prototype.flash=function(){var a=this;this.pane.addClass("flashed");setTimeout(function(){a.pane.removeClass("flashed")},this.options.flashDelay);return this};return b}();
d.fn.nanoScroller=function(b){return this.each(function(){var a;if(!(a=this.nanoscroller))a=d.extend({},n),this.nanoscroller=a=new m(this,a);if("object"===typeof b){d.extend(a.options,b);if(b.scrollBottom)return a.scrollBottom(b.scrollBottom);if(b.scrollTop)return a.scrollTop(b.scrollTop);if(b.scrollTo)return a.scrollTo(b.scrollTo);if("bottom"===b.scroll)return a.scrollBottom(0);if("top"===b.scroll)return a.scrollTop(0);if(b.scroll&&b.scroll instanceof d)return a.scrollTo(b.scroll);if(b.stop)return a.stop();
if(b.flash)return a.flash()}return a.reset()})}})(jQuery,window,document);